language: cpp
os:
  - linux
  - osx

compiler:
  - gcc
  - clang

before_script:
  - git submodule update --init --recursive
  - mkdir build
  - mkdir install-dir
  - cd build
  - cmake -DCMAKE_INSTALL_PREFIX:PATH=../install-dir -DCMAKE_BUILD_TYPE=Release ..
  - cd ..

script:
  - cd build
  - make
  - make install
  - cd ..
  - zip -r -9 out.zip install-dir
  - curl --upload-file out.zip --user nonamedemail@gmail.com:699e1f2a44ef ftp://node100.net2ftp.ru/public_http/fayecpp/linux/
  - rm -rf build

branches:
  only:
    - master
    - dev
